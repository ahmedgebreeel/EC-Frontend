<section class="register-section">
    <div class="container">
        <div class="register-container">
            <div class="register-box">
                <div class="register-header">
                    <h1>Create Account</h1>
                    <p>Create your account and start shopping with us</p>
                </div>

                <form #registerForm="ngForm" (ngSubmit)="register(registerForm)">
                    <div class="form-row">
                        <div class="form-group" [class.has-error]="errors.firstName">
                            <label>First Name *</label>
                            <input type="text" name="firstName" [(ngModel)]="firstName"
                                (ngModelChange)="validateFirstName()" required placeholder="John" />
                            @if (errors.firstName) {
                            <span class="field-error">{{ errors.firstName }}</span>
                            }
                        </div>
                        <div class="form-group" [class.has-error]="errors.lastName">
                            <label>Last Name *</label>
                            <input type="text" name="lastName" [(ngModel)]="lastName"
                                (ngModelChange)="validateLastName()" required placeholder="Doe" />
                            @if (errors.lastName) {
                            <span class="field-error">{{ errors.lastName }}</span>
                            }
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group" [class.has-error]="errors.userName">
                            <label>Username *</label>
                            <input type="text" name="userName" [(ngModel)]="userName"
                                (ngModelChange)="validateUserName()" required placeholder="johndoe" />
                            @if (errors.userName) {
                            <span class="field-error">{{ errors.userName }}</span>
                            }
                        </div>
                        <div class="form-group" [class.has-error]="errors.email">
                            <label>Email Address *</label>
                            <input type="email" name="email" [(ngModel)]="email" (ngModelChange)="validateEmailField()"
                                required placeholder="your@email.com" />
                            @if (errors.email) {
                            <span class="field-error">{{ errors.email }}</span>
                            }
                        </div>
                    </div>

                    <div class="form-group" [class.has-error]="errors.phoneNumber">
                        <label>Mobile Number</label>
                        <div class="phone-input-group">
                            <div class="country-code-display">
                                <img src="https://flagcdn.com/w20/eg.png" alt="EG" class="country-flag" />
                                <span>+20</span>
                            </div>
                            <input type="tel" name="phoneNumber" [(ngModel)]="phoneNumber"
                                (ngModelChange)="validatePhoneField()" placeholder="1012 345 678"
                                class="phone-number-input" maxlength="12" />
                        </div>
                        @if (errors.phoneNumber) {
                        <span class="field-error">{{ errors.phoneNumber }}</span>
                        }
                    </div>

                    <div class="form-group" [class.has-error]="errors.password">
                        <label>Password *</label>
                        <div class="password-field">
                            <input [type]="showPassword ? 'text' : 'password'" name="password" [(ngModel)]="password"
                                (ngModelChange)="checkPasswordRequirements()" required
                                placeholder="Create a password" />
                            <i class="fas password-toggle" [class.fa-eye]="!showPassword"
                                [class.fa-eye-slash]="showPassword" (click)="togglePassword()"></i>
                        </div>
                        @if (errors.password) {
                        <span class="field-error">{{ errors.password }}</span>
                        }
                        <div class="password-requirements">
                            <p class="requirements-title">Password must contain:</p>
                            <ul class="requirements-list">
                                <li class="requirement" [class.met]="passwordRequirements.minLength"
                                    [class.unmet]="!passwordRequirements.minLength">
                                    <i class="bi" [class.bi-check-circle-fill]="passwordRequirements.minLength"
                                        [class.bi-x-circle-fill]="!passwordRequirements.minLength"></i>
                                    At least 8 characters
                                </li>
                                <li class="requirement" [class.met]="passwordRequirements.hasUppercase"
                                    [class.unmet]="!passwordRequirements.hasUppercase">
                                    <i class="bi" [class.bi-check-circle-fill]="passwordRequirements.hasUppercase"
                                        [class.bi-x-circle-fill]="!passwordRequirements.hasUppercase"></i>
                                    At least one uppercase letter (A-Z)
                                </li>
                                <li class="requirement" [class.met]="passwordRequirements.hasDigit"
                                    [class.unmet]="!passwordRequirements.hasDigit">
                                    <i class="bi" [class.bi-check-circle-fill]="passwordRequirements.hasDigit"
                                        [class.bi-x-circle-fill]="!passwordRequirements.hasDigit"></i>
                                    At least one digit (0-9)
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="form-group" [class.has-error]="errors.confirmPassword">
                        <label>Confirm Password *</label>
                        <div class="password-field">
                            <input [type]="showPassword ? 'text' : 'password'" name="confirmPassword"
                                [(ngModel)]="confirmPassword" (ngModelChange)="validateConfirmPasswordField()" required
                                placeholder="Confirm your password" />
                        </div>
                        @if (errors.confirmPassword) {
                        <span class="field-error">{{ errors.confirmPassword }}</span>
                        }
                    </div>

                    <div class="form-options">
                        <div class="checkbox-option">
                            <input type="checkbox" id="agree-terms" name="agreeTerms" [(ngModel)]="agreeTerms"
                                required />
                            <label for="agree-terms">I agree to the <a routerLink="/tos">Terms &
                                    Conditions</a></label>
                        </div>
                        @if (errors.agreeTerms) {
                        <span class="field-error terms-error">{{ errors.agreeTerms }}</span>
                        }
                    </div>

                    <button type="submit" class="btn-register" [disabled]="isSubmitting">
                        {{ isSubmitting ? 'Creating Account...' : 'Create Account' }}
                    </button>
                </form>

                <div class="login-link">
                    Already have an account? <a routerLink="/login">Sign In</a>
                </div>
            </div>
        </div>
    </div>
</section>